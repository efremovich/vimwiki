# Задачи
## Проблемы (Указать число)
- [X] [Обмен данными, ошибки при загрузке транзакций.](#Обмен-данными-и-загрузка-транзакций)
- [X] [Полная перезагрузка транзакций с удалением данных в статусе "Запрос"](#Полная-перезагрузка-транзакций)
- [X] [Расхождение в статусах карт и лимитах](#Расхождение-в-статусах-карт-и-лимитах)
- [ ] Не корректно происходит разблокировка при пополнении счета клиентом
- [ ] Блокировка одного вида топлива у бюджетных клиентов (ограничение по контракту)
- [ ] Смена лимита по эмитенту СТГ
- [ ] Контроль блокировки по сумме договора
- [ ] Нужна кнопка блокировки в договоре

## Исправление и изменения
### Обмен данными и загрузка транзакций
Переработана система загрузки транзакций.
- Добавлены фоновые процессы, которые каждые 5 минут запускаются, происходит загрузка транзакций за текущие сутки.
- Каждый день в 04:00 происходит полная выгрузка данных, с очисткой накопленных данных, в кабинет клиента.

Переработана форма ручной загрузки транзакций.
Добавлена возможность загрузки транзацкии по отдельным эмитентам.

![Изменения на форме](./src/getTrans.png)

### Полная перезагрузка транзакций
Каждую ночь, в 23:45 запускается задача которая загружает транзакции за месяц с удалением всех накопленных транзакций т.е. происходит полная перезагрузка. *Ликард:* если транзакция в статусе запрос находиться более 1 суток, то не будет.

### Расхождение в статусах карт и лимитах
Для устранения этой проблемы был создан специальный метод сравнения текущего статуса топливной карты с данными в топливном кабинете эмитента. В случае если статусы были различны, то было установлено значение из 1с.
Так же новый метод позволяет сверить лимиты, но запускать его опасно.

